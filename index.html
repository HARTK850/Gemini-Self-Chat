<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Self-Chat - צ'אט עם עצמי</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div id="loading" class="loading">
        <div class="loading-spinner"></div>
        <div class="loading-text">טוען...</div>
    </div>

    <div id="apiSetup" class="container">
        <div class="setup-card">
            <div class="setup-header">
                <i class="fas fa-key"></i>
                <h1>הגדרת Gemini API</h1>
                <p>הכנס את מפתח ה-API שלך כדי להתחיל</p>
            </div>
            <form id="apiForm">
                <div class="input-group">
                    <label for="apiKey">מפתח API של Gemini:</label>
                    <input type="password" id="apiKey" placeholder="הכנס את מפתח ה-API שלך..." required>
                    <button type="button" id="toggleApiKey" class="toggle-password">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i>
                    שמור והתחל
                </button>
                <p class="help-text">המפתח נשמר מקומית בדפדפן שלך בלבד.</p>
            </form>
        </div>
    </div>

    <div id="mainApp" class="main-content hidden">
        <div class="sidebar">
            <div class="logo">
                <i class="fas fa-robot"></i>
                <span>Gemini Chat</span>
            </div>
            <div class="menu-items">
                <button id="newChatBtn" class="menu-item active">
                    <i class="fas fa-plus"></i>
                    צ'אט חדש
                </button>
                <button id="settingsBtn" class="menu-item">
                    <i class="fas fa-cog"></i>
                    הגדרות מתקדמות
                </button>
            </div>
            <div class="sidebar-footer">
                <div id="tokenEstimator" class="token-info hidden">
                    <small>צפי טוקנים: <span id="tokenCount">0</span></small>
                </div>
            </div>
        </div>

        <div class="content-area">
            <div id="welcomeScreen" class="welcome-screen">
                <div class="welcome-header">
                    <h2>הגדרת שיחה חדשה</h2>
                    <p>בחר דמות ונושא או צור משלך</p>
                </div>

                <div class="setup-tabs">
                    <button class="tab-btn active" data-tab="characters">דמויות מוכנות</button>
                    <button class="tab-btn" data-tab="custom">מותאם אישית</button>
                    <button class="tab-btn" data-tab="models">מודלים וסיבובים</button>
                </div>

                <div id="charactersTab" class="tab-content active">
                    <div class="character-grid">
                        <div class="char-card" data-role="philosopher">
                            <i class="fas fa-brain"></i>
                            <h3>הפילוסוף</h3>
                            <p>חשיבה עמוקה וניתוח לוגי</p>
                        </div>
                        <div class="char-card" data-role="debater">
                            <i class="fas fa-gavel"></i>
                            <h3>הווכחן</h3>
                            <p>מאתגר כל טענה ומחפש סתירות</p>
                        </div>
                        <div class="char-card" data-role="creative">
                            <i class="fas fa-paint-brush"></i>
                            <h3>היוצר</h3>
                            <p>חשיבה מחוץ לקופסה ורעיונות מקוריים</p>
                        </div>
                        <div class="char-card" data-role="scientist">
                            <i class="fas fa-flask"></i>
                            <h3>המדען</h3>
                            <p>מבוסס עובדות, מחקר וראיות</p>
                        </div>
                    </div>
                    
                    <div class="topic-input-container">
                        <label>על מה נדבר היום?</label>
                        <input type="text" id="chatTopic" placeholder="למשל: עתיד הבינה המלאכותית, משמעות החיים...">
                    </div>
                </div>

                <div id="customTab" class="tab-content">
                    <div class="input-group">
                        <label>מי הדמות המשיבה?</label>
                        <textarea id="customPersona" rows="3" placeholder="תאר את האופי, הסגנון והמומחיות של הדמות..."></textarea>
                    </div>
                    <div class="input-group">
                        <label>הנחיות נוספות לתשובה</label>
                        <textarea id="answerInstructions" rows="2" placeholder="למשל: תענה בקצרה, תהיה ציני, תשתמש במטאפורות..."></textarea>
                    </div>
                </div>

                <div id="modelsTab" class="tab-content">
                    <div class="settings-grid">
                        <div class="input-group">
                            <label><i class="fas fa-user-tie"></i> מודל שואל (מנחה)</label>
                            <select id="questionerModel" class="model-select">
                                <option value="gemini-1.5-flash">Gemini 1.5 Flash (מהיר)</option>
                                <option value="gemini-1.5-pro">Gemini 1.5 Pro (חכם)</option>
                                <option value="gemini-2.0-flash-exp">Gemini 2.0 Flash (ניסיוני)</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label><i class="fas fa-robot"></i> מודל עונה (דמות)</label>
                            <select id="answererModel" class="model-select">
                                <option value="gemini-1.5-flash">Gemini 1.5 Flash (מהיר)</option>
                                <option value="gemini-1.5-pro" selected>Gemini 1.5 Pro (חכם)</option>
                                <option value="gemini-2.0-flash-exp">Gemini 2.0 Flash (ניסיוני)</option>
                            </select>
                        </div>
                    </div>

                    <div class="rounds-control">
                        <div class="toggle-container">
                            <label class="switch">
                                <input type="checkbox" id="infiniteMode">
                                <span class="slider round"></span>
                            </label>
                            <span>מצב שיחה אינסופי (עד לעצירה ידנית)</span>
                        </div>
                        
                        <div id="roundsInputContainer" class="input-group mt-2">
                            <label>מספר סיבובים לשיחה:</label>
                            <input type="number" id="roundsCount" min="1" max="50" value="5">
                            <small class="text-muted">צפי טוקנים משוער: <span id="estTokens">3000</span></small>
                        </div>
                    </div>
                </div>

                <div class="action-area">
                    <button id="startChatBtn" class="btn btn-primary btn-lg">
                        <i class="fas fa-play"></i>
                        התחל צ'אט
                    </button>
                </div>
            </div>

            <div id="chatContainer" class="chat-container hidden">
                <div class="chat-header">
                    <div class="chat-info">
                        <h2 id="chatTitle">נושא השיחה</h2>
                        <span id="chatStatus" class="status-badge">פעיל</span>
                    </div>
                    <div class="chat-controls">
                        <span id="roundCounter" class="round-badge">סיבוב 1/5</span>
                        
                        <button id="stopChatBtn" class="btn btn-danger hidden">
                            <i class="fas fa-stop"></i> עצור
                        </button>
                        
                        <button id="pauseBtn" class="btn-icon" title="השהה/המשך">
                            <i class="fas fa-pause"></i>
                        </button>
                        
                        <button id="podcastBtn" class="btn btn-success hidden">
                            <i class="fas fa-microphone-alt"></i> הפק פודקאסט
                        </button>

                        <button id="exportBtn" class="btn-icon" title="ייצוא שיחה">
                            <i class="fas fa-download"></i>
                        </button>
                    </div>
                </div>
                
                <div id="chatMessages" class="chat-messages">
                    </div>
                
                <div class="chat-footer">
                    <button id="continueBtn" class="btn btn-secondary hidden">
                        המשך שיחה
                    </button>
                    <div id="podcastPlayer" class="podcast-player hidden">
                        <div class="podcast-controls">
                            <span><i class="fas fa-podcast"></i> מתנגן כעת...</span>
                            <button id="stopPodcastBtn" class="btn-small"><i class="fas fa-stop"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="settingsModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-cog"></i> הגדרות מערכת</h3>
                <button id="closeSettingsModal" class="btn-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label for="newApiKey">עדכן מפתח API:</label>
                    <input type="password" id="newApiKey" placeholder="מפתח API חדש...">
                    <button type="button" id="toggleNewApiKey" class="toggle-password">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <div class="input-group">
                    <button id="clearHistory" class="btn btn-danger">
                        <i class="fas fa-trash"></i>
                        נקה היסטוריה ומטמון
                    </button>
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveSettings" class="btn btn-primary">
                    <i class="fas fa-save"></i>
                    שמור שינויים
                </button>
            </div>
        </div>
    </div>

    <script src="script.js" type="module"></script>
</body>
</html>
